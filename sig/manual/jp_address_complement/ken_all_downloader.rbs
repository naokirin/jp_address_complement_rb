# KenAllDownloader: 郵便番号データ（ken_all.zip）のダウンロード・展開
# tmpdir, rubyzip は sig/manual のスタブを参照

module JpAddressComplement
  class KenAllDownloader
    DEFAULT_URL: String
    CSV_FILENAME: String

    class DownloadError < JpAddressComplement::Error
    end

    def initialize: (?String url) -> void

    def download_and_extract: () -> String

    private

    def download_zip: () -> String

    def fetch_to_path: (String path) -> void

    def write_response_to_path: (Net::HTTPResponse response, String path) -> void

    def extract_zip: (String zip_path) -> String

    def extract_zip_entries: (String zip_path, String tmpdir) -> String?

    def entry_csv?: (String entry_name, String dest) -> bool

    def find_csv_in_dir: (String tmpdir) -> String?
  end
end
